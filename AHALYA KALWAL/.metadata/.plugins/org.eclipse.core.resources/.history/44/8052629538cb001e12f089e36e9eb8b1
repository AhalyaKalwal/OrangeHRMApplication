package com.OrangeHRMApplication;

import java.io.FileInputStream;
import java.io.IOException;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.annotations.Test;

public class LoginFunctionality {
	FileInputStream loginTestDataFile;
	XSSFWorkbook workbook;
	XSSFSheet logintestdataSheet;
	Row rowtestdata;

	@Test(priority = 1)
	public void loginFunctionality() throws IOException {


		loginTestDataFile = new FileInputStream("./src/com/Excelsheet/PIM_MultipleTestData.xlsx");
		workbook = new XSSFWorkbook(loginTestDataFile);
		logintestdataSheet = workbook.getSheet("PIM2");
		Row rowtestdata = logintestdataSheet.getRow(2);

		Cell logInPanelTestDataCell = rowtestdata.getCell(0);
		String logInPanelTestData = logInPanelTestDataCell.getStringCellValue();

		String expected_OrangeHRMApplicationLoginPanel = logInPanelTestData;
		System.out.println(
				"The expected orangeHRM application login panel text is:-" + expected_OrangeHRMApplicationLoginPanel);
		// <div id="logInPanelHeading">LOGIN Panel</div>
		By loginpanelProperty = By.id("logInPanelHeading");
		WebElement loginpanelText = driver.findElement(loginpanelProperty);

		String actual_OrangeHRMApplicationLoginPanel = loginpanelText.getText();
		System.out.println(
				"The actual orangeHRM application login panel text is:-" + actual_OrangeHRMApplicationLoginPanel);
		if (actual_OrangeHRMApplicationLoginPanel.equals(expected_OrangeHRMApplicationLoginPanel)) {
			System.out.println("Successfully navigated to orangehrm application login page text:-PASS");
			Cell testRowOfCell = rowtestdata.createCell(1);
			testRowOfCell.setCellValue("LOGIN Panel");
			testRowOfCell = rowtestdata.createCell(2);
			testRowOfCell.setCellValue("Successfully navigated to orangehrm application login page text:-PASS");
		} else {
			System.out.println("Failed to navigate to orangehrm application login page text:-FAIL");
			Cell testRowOfCell = rowtestdata.createCell(1);
			testRowOfCell.setCellValue("Not Matched");
		}
		Cell orangehrmtitleTestDataCell = rowtestdata.getCell(3);
		String orangehrmTestData = orangehrmtitleTestDataCell.getStringCellValue();
		String expected_OrangeHRMApplicationLoginPageTitle = orangehrmTestData;
		System.out.println("The expected orangeHRM Application login page title is :-"+ expected_OrangeHRMApplicationLoginPageTitle);
		String actual_OrangeHRMApplicationLoginPageTitle = driver.getTitle();
		System.out.println("The actual orangeHRM Application login page title is :-" + actual_OrangeHRMApplicationLoginPageTitle);

		if (actual_OrangeHRMApplicationLoginPageTitle.equals(expected_OrangeHRMApplicationLoginPageTitle)) {
			System.out.println("succesfully navigated to login page Title-PASS");
			Cell testRowOfCell = rowtestdata.createCell(4);
			testRowOfCell.setCellValue(actual_OrangeHRMApplicationLoginPageTitle);
			testRowOfCell = rowtestdata.createCell(5);
			testRowOfCell.setCellValue("Successfully navigated to orangehrm application login page text:-PASS");
		}
		else
		{
			System.out.println("Failed to navigate to login page Title-FAIL");
			Cell testRowOfCell = rowtestdata.createCell(4);
			testRowOfCell.setCellValue(actual_OrangeHRMApplicationLoginPageTitle);
			testRowOfCell = rowtestdata.createCell(5);
			System.out.println("Failed to navigate to login page Title-FAIL");
		}

		rowtestdata = logintestdataSheet.getRow(2);
		Cell userNameTestDataCell = rowtestdata.getCell(6);
		String userNameTestData = userNameTestDataCell.getStringCellValue();

		By usernameProperty = By.id("txtUsername");
		WebElement username = driver.findElement(usernameProperty);
		username.sendKeys(userNameTestData);
		Cell passwordTestDataCell = rowtestdata.getCell(7);
		String passwordTestData = passwordTestDataCell.getStringCellValue();
		By passwordProperty = By.id("txtPassword");
		WebElement password = driver.findElement(passwordProperty);
		password.sendKeys(passwordTestData);

		//    	<input type="submit" name="Submit" class="button" id="btnLogin" value="LOGIN">
		By loginInButtonProperty = By.className("button");
		WebElement loginInButton = driver.findElement(loginInButtonProperty);
		loginInButton.click();

		Cell welcomeAdmintestdatacell = rowtestdata.getCell(8);
		String welcomeAdmin = welcomeAdmintestdatacell.getStringCellValue();
		String expected_welcomeAdmin = welcomeAdmin;
		System.out.println("The expected orangehrm application welcome admin link is:-" + expected_welcomeAdmin);
		By welcomeadminProperty = By.id("welcome");
		WebElement welcomeadmin = driver.findElement(welcomeadminProperty);

		String actual_welcomeAdmin = welcomeadmin.getText();
		System.out.println("The actual orangehrm application welcome admin link is:-" + actual_welcomeAdmin);
		if (actual_welcomeAdmin.contains(expected_welcomeAdmin)) {
			System.out.println("successfully matched with the welcome admin text:-PASS");
			Cell testRowOfCell = rowtestdata.createCell(9);
			testRowOfCell.setCellValue("Welcome");
			testRowOfCell = rowtestdata.createCell(10);
			testRowOfCell.setCellValue("successfully matched with the welcome admin text:-PASS");
		} else {
			System.out.println("Failed to match with the welcome admin text:-FAIL");
			Cell testRowOfCell = rowtestdata.createCell(9);
			testRowOfCell.setCellValue("Welcome");
			testRowOfCell.setCellValue("Not Matched");
		}

		//FileOutputStream testResultFile = new FileOutputStream(
		//		"./src/com/orangehrmexcelResultsfile/AddEmployeeMultipleTestDataResult.xlsx");
		//workbook.write(testResultFile);


	}


}
